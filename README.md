# Terraform GitHub Actions Pipeline 🚀

## What This Pipeline Does
This GitHub Actions workflow automatically manages your Terraform infrastructure with the following steps:

| Event               | Job Run       | Action                     | Automatic? |
|------------------|-------------|--------------------------|------------|
| Pull Request Opened | `plan`      | Validate + Preview Plan   | ✅ Yes     |
| Pull Request Approved | Nothing    | Waits for Merge          | ❌ No     |
| Branch Merged       | `apply`     | Deploy Infrastructure     | ✅ Yes     |
| Push to Main        | `apply`     | Deploy Infrastructure     | ✅ Yes     |

---

## Folder Structure
```bash
.
├── .github/
│   └── workflows/
│       └── terraform.yml # The GitHub Actions workflow
├── main.tf              # Your Terraform code
├── variables.tf         # Terraform variables
└── outputs.tf           # Terraform outputs
└── README.md            # Documentation
```

---

## How the Pipeline Works 🔥
### 1. Pull Request Event (Plan)
When a **Pull Request** is opened to the `main` branch, the pipeline will:
- Checkout your code
- Install Terraform
- Run `terraform init`
- Validate your Terraform code
- Preview the Terraform Plan (without applying it)
- Add a **PR Comment** showing the plan using GitHub Actions Bot 🤖

✅ Example PR Comment:
```
#### Terraform Format and Style 🖌success
#### Terraform Initialization ⚙️success
#### Terraform Validation 🤖success
#### Terraform Plan 📖success

<details><summary>Show Plan</summary>

```terraform
resource "aws_s3_bucket" "example" {
  bucket = "my-bucket-name"
}
```

</details>

Pushed by: @adrianjleon
```

---

### 2. Merge Event (Apply)
If the Pull Request is **merged** into the `main` branch, the pipeline will automatically:
- Checkout your code
- Install Terraform
- Run `terraform init`
- **Apply the infrastructure changes**

✅ Example Console Output:
```
Terraform Apply Complete!
Apply complete! Resources: 1 added, 0 changed, 0 destroyed.
```

---

## How to Set Up This Pipeline 🔥
### 1. Create Terraform Cloud API Token
1. Go to 👉 https://app.terraform.io/
2. Go to **User Settings ➡️ Tokens ➡️ Create API Token**
3. Copy the Token 🔑

### 2. Add GitHub Secrets
Go to your GitHub Repository:
- **Settings ➡️ Secrets and variables ➡️ Actions ➡️ New Repository Secret**

| Secret Name    | Value                |
|---------------|---------------------|
| `TF_API_TOKEN` | 🔑 Your Terraform Cloud API Token |
| `GITHUB_TOKEN` | Automatically generated by GitHub |

---

## How to Use It 🔑
1. Push your Terraform code to your repo
2. Create a Pull Request
3. Wait for the **Terraform Plan** comment
4. If everything is correct, **Merge the PR**
5. Watch your infrastructure deploy automatically 🚀

---

## How to Customize It 🔥
If you want to **require manual approval** before running `terraform apply`, add this to your `apply` job:
```yaml
environment:
  name: production
  url: https://app.terraform.io/
```

---

## Features Added ✅
- CI/CD for Terraform
- Automatic Pull Request Comments
- Infrastructure Deployment on Merge
- Secrets with GitHub Actions



